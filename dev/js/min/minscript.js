var homePageTimer;var queryBeg="http://otter.atlasapi.org/3.0/";var clearTimer=function(){clearInterval(homePageTimer)};var apiFuncRun=false;var message=false;var Tabs=function(){this.tabHolder;this.count=0;this.active;this.tab=[];this.page=[]};Tabs.prototype.init=function(b){var a=this;a.tabHolder=b;var c=[];b.find(".tab").each(function(d){if($(this).hasClass("tabExt")){a.tab[d]={id:$(this).attr("data-tab"),li:$(this),a:$(this)}}else{a.tab[d]={id:$(this).find("a").attr("data-tab"),li:$(this),a:$(this).find("a")}}a.tab[d].a.click(function(){a.changeTab(d)});a.count++});b.find(".tabArea").each(function(d){a.page[d]={index:d,item:$(this)};a.page[d].item.hide()})};Tabs.prototype.changeTab=function(b){var a=this;a.tabHolder.find(".tab.selected").removeClass("selected");a.tabHolder.find(".tabArea:visible").hide();a.tab[b].li.addClass("selected");a.page[b].item.show();a.active=b};var SubTabs=function(){this.tabHolder;this.count=0;this.active;this.tab=[];this.page=[]};SubTabs.prototype.init=function(b){var a=this;a.tabHolder=b;var c=[];b.find(".subTab").each(function(d){if($(this).hasClass("subTabExt")){a.tab[d]={id:$(this).attr("data-tab"),li:$(this),a:$(this)}}else{a.tab[d]={id:$(this).find("a").attr("data-tab"),li:$(this),a:$(this).find("a")}}a.tab[d].a.click(function(){a.changeTab(d);window.location.hash="apiExplorer";return false});a.count++});b.find(".subTabArea").each(function(d){a.page[d]={index:d,item:$(this)};a.page[d].item.hide()})};SubTabs.prototype.changeTab=function(b){var a=this;a.tabHolder.find(".subTab.selected").removeClass("selected");a.tabHolder.find(".subTabArea:visible").hide();a.tab[b].li.addClass("selected");a.page[b].item.show();a.active=b};var PageInfo=function(){this.pageWidth;this.pageHeight;this.pageOffset;this.section=[];this.sections;this.subSection=[];this.subSections;this.currentSection;this.currentSubSection;this.menuClick=false;this.currentEvent;this.changePageTimer=false};PageInfo.prototype.init=function(){var a=this;a.update(true,true,true);$("section:not(.subSection)").each(function(b){a.section[b]={item:$(this),name:$(this).attr("class"),position:$(this).find(".marker").offset().top,subSection:[],subSections:""};$(this).find(".subSection").each(function(d){a.section[b].subSection[d]={item:$(this),name:$(this).attr("data-title"),position:$(this).find(".marker").offset().top};var c=$('.mainMenu a[href="#'+a.section[b].name+'"]').offset().left;a.section[b].item.find(".subNav").css({left:c-2})});a.section[b].subSections=a.section[b].subSection.length});a.sections=a.section.length-1;$("section.subSection").each(function(b){a.subSection[b]={name:$(this).attr("data-title"),position:$(this).find(".marker").offset().top,parent:$(this).parent().attr("class")}});a.subSections=a.subSection.length;$("body").keyup(function(b){})};PageInfo.prototype.update=function(e,b,g){var d=this;if(e){d.pageWidth=$(window).width()}if(b){d.pageHeight=$(window).height()}if(g){d.pageOffset=$(window).scrollTop();for(i=0;i<d.sections;i++){if(i<d.sections){var a=i+1;if(d.pageOffset>d.section[i].position&&d.pageOffset<d.section[a].position){if(d.currentSection!=i){d.changePage(i);if(d.section[i].subSection.length-1>0){d.changeSubSection(0)}}if(d.section[i].subSections>0){var c=d.section[i].subSection.length-1;for(ii=0;ii<c;ii++){var f=ii+1;if(d.pageOffset>d.section[i].subSection[ii].position&&d.pageOffset<d.section[i].subSection[f].position){if(d.currentSubSection!=ii){d.changeSubSection(ii)}}else{if(d.pageOffset>=d.section[i].subSection[c].position){if(d.currentSubSection!=c){d.changeSubSection(c)}}}}}}else{if(d.pageOffset>=d.section[d.sections].position){if(d.currentSection!=d.sections){d.changePage(d.sections)}}}}}}};PageInfo.prototype.changePage=function(a){var b=this;if(b.changePageTimer!=false){clearTimeout(b.changePageTimer)}$("header a.selected").removeClass("selected");$('header a[href="#'+b.section[a].name+'"]').addClass("selected");if(b.section[a].subSections==0){b.changeHash(b.section[a].name)}if(a==0&&!$("a.logo").hasClass("defaultCursor")){$("a.logo").addClass("defaultCursor")}else{if(a>0&&$("a.logo").hasClass("defaultCursor")){$("a.logo").removeClass("defaultCursor")}}b.currentSection=a;if(b.section[a].subSections>0){if(!$("."+b.section[a].name).find(".subNav").is(":visible")){$(".subNav:visible").fadeOut();$("."+b.section[a].name).find(".subNav").fadeIn()}}else{$(".subNav:visible").fadeOut()}};PageInfo.prototype.changeSubSection=function(d){var e=this;if(e.changePageTimer!=false){clearTimeout(e.changePageTimer)}var a=e.section[e.currentSection].name;var c=e.section[e.currentSection].subSection[d].name,b=c.substr(c.indexOf("_"));$("."+a+" .subNav a.selected").removeClass("selected");$("."+a+' .subNav a[href="#'+c+'"]').addClass("selected");if(e.section[d].subSections==0){e.changeHash(c)}e.currentSubSection=d};PageInfo.prototype.changeHash=function(b){var a=this;a.changePageTimer=setTimeout(function(){var c=location.href.substr(0,location.href.indexOf("#"))+"#"+b;if(Modernizr.history){window.history.pushState(null,null,c)}},1000)};function initialCap(a){a=a.substr(0,1).toUpperCase()+a.substr(1);return a}var HomeDemo=function(c){this.active=false;var e=[{type:"Discover",query:"discover.json?publisher=bbc.co.uk&available=true&limit=5"},{type:"Discover",query:"discover.json?genre=drama&availableCountries=uk&mediaType=audio&limit=5"},{type:"Search",query:"search.json?q=east&limit=5"},{type:"Discover",query:"discover.json?publisher=itv.com&limit=5"},{type:"Discover",query:"discover.json?publisher=seesaw.com&limit=5"},{type:"Discover",query:"discover.json?publisher=bbc.co.uk&genre=comedy&limit=5"},{type:"Discover",query:"discover.json?publisher=hulu.com&limit=5"},{type:"Search",query:"search.json?q=Britain&limit=5"},{type:"Discover",query:"discover.json?publisher=bbc.co.uk&genre=factual&limit=5"},{type:"Discover",query:"discover.json?publisher=video.uk.msn.com&limit=5"}];var a=Math.floor(Math.random()*e.length);var d=e.slice(0,a);var b=e.slice(a);this.query=b.concat(d);this.activeQuery=0;this.marker=0;this.time=20000;this.timer;this.nav=c;this.item=[];this.width=$(".queryHolder").width();this.prevBtn=c.find(".cbtn.previous");this.nextBtn=c.find(".cbtn.next");this.scrolling=false};HomeDemo.prototype.init=function(){var b=this;var a=b.nav.find(".queries");a.append('<a href="'+queryBeg+b.query[b.activeQuery].query+'" class="query api api'+b.query[b.activeQuery].type+'">'+queryBeg+b.query[b.activeQuery].query+"</a>");b.nav.find(".cbtn").click(function(){if(!$(this).hasClass("inactive")){if($(this).hasClass("previous")){if(b.activeQuery>1&&a.children().length>1){b.scrolling=true;clearInterval(b.timer);b.activeQuery--;b.prevQuery();b.nextBtn.removeClass("inactive")}}else{if($(this).hasClass("next")){if(!$(this).hasClass("wait")){if(b.activeQuery<b.marker){b.scrolling=true;clearInterval(b.timer);b.activeQuery++;if(b.activeQuery==10){b.activequery=0}b.nextQuery();if(b.activeQuery==b.marker){b.prevBtn.removeClass("inactive");b.countdown();b.scrolling=false}}else{clearInterval(b.timer);if(b.activeQuery==10){b.activeQuery=0}b.nextQuery();b.request()}}}}}return false});b.request()};HomeDemo.prototype.request=function(){var c=this;clearTimeout(c.timer);c.prevBtn.addClass("inactive");c.nextBtn.addClass("inactive");c.nav.find(".timer .js_txt").html("Loading");var b=(c.activeQuery*2)+1;var a=(c.activeQuery*2)+2;b=$(".slideShow .showItem:nth-child("+b+")");a=$(".slideShow .showItem:nth-child("+a+")");if((!b.find("img").attr("src")||b.find("img").height()==0)||(!a.find("img").attr("src")||a.find("img").height()==0)){$.ajax({url:queryBeg+c.query[c.activeQuery].query,dataType:"jsonp",jsonpCallback:"jsonp",cache:true,timeout:5000,context:c.item,success:function(f,g,e){c.nav.find(".timer").fadeOut();var d=processTheJson(f);d.clean(undefined);if(d.length>0){if(d[0]!=undefined){if(!b.find("img").attr("src")||b.find("img").height()==0){b.find("img").attr("src",d[0].image).fadeIn(500,function(){b.removeClass("loading")})}b.attr("href",queryBeg+"content.json?uri="+d[0].uri);b.find(".br").html(d[0].brand);b.find(".pub").html("("+d[0].publisher+")");b.find(".ep").html(d[0].episode);b.find(".caption").fadeIn()}if(d[1]!=undefined){if(!a.find("img").attr("src")||a.find("img").height()==0){a.find("img").attr("src",d[1].image).fadeIn(500,function(){b.removeClass("loading")})}a.attr("href",queryBeg+"content.json?uri="+d[1].uri);a.find(".br").html(d[1].brand);a.find(".pub").html("("+d[1].publisher+")");a.find(".ep").html(d[1].episode);a.find(".caption").fadeIn()}else{a.removeClass("loading")}}},error:function(d,f,e){},complete:function(d,e){if(c.activeQuery<c.query.length-1){c.activeQuery++;c.marker++}else{c.activeQuery=0;c.marker=0}c.countdown();if(c.marker>1){c.prevBtn.removeClass("inactive")}c.nextBtn.removeClass("inactive")}})}else{if(c.activeQuery<c.query.length-1){c.activeQuery++;c.marker++}else{c.activeQuery=0;c.marker=0}c.countdown();if(c.marker>1){c.prevBtn.removeClass("inactive")}c.nextBtn.removeClass("inactive")}};HomeDemo.prototype.nextQuery=function(){var c=this;var b=c.nav.find(".queries");var a=$(".slideShow .slideshowItem");if(c.activeQuery!=0){if(b.children().length<10&&c.scrolling==false){var d=b.children("a:last-child").clone();d.removeAttr("class").attr("class","query api api"+c.query[c.activeQuery].type);d.attr("href",queryBeg+c.query[c.activeQuery].query).html(queryBeg+c.query[c.activeQuery].query);d.appendTo(b)}b.animate({left:"-="+c.width},1000);a.animate({left:"-=960"},1000)}else{b.animate({left:"0"},1000);a.animate({left:"0"},1000)}if(c.activeQuery<=c.marker&&c.prevBtn.hasClass("inactive")){c.prevBtn.removeClass("inactive")}};HomeDemo.prototype.prevQuery=function(){var c=this;var b=c.nav.find(".queries");var a=$(".slideShow .slideshowItem");c.nav.find(".timer").fadeOut();if(c.activeQuery!=9){b.animate({left:"+="+c.width},1000);a.animate({left:"+=960"},1000)}if(c.activeQuery==1){c.prevBtn.addClass("inactive")}};HomeDemo.prototype.countdown=function(){var c=this;clearInterval(c.timer);var b=20;var a=c.nav.find(".timer");if(c.buttonClicked){if(c.activeQuery==c.marker){a.fadeIn();c.timer=setInterval(function(){a.find(".js_txt").html(b+"s");b--;if(b==-1){a.find(".js_txt").html("Loading");clearTimer(c.timer);c.request()}},1000)}else{a.fadeOut()}}else{c.timer=setInterval(function(){if(!a.is(":visible")){a.fadeIn()}a.find(".js_txt").html(b+"s");b--;if(b==-1){a.find(".js_txt").html("Loading");clearTimer(c.timer);c.nextQuery();c.request()}},1000)}};var ApiExplorer=function(a){this.holder=a;this.queryType;this.query;this.btn=$('.btn[value="Run"]');this.queryBar=[];this.timedOut=false};ApiExplorer.prototype.buttonHandler=function(){var a=this;$("a.btnCopy").hover(function(){if($(this).attr("data-bound")!="true"){var b=new ZeroClipboard.Client();b.glue($(this).attr("id"));b.setHandCursor(true);b.setText($(this).siblings('input[type="text"]').val());$(this).attr("data-bound","true")}});$(".urlCopy").each(function(b){a.queryBar[b]={txt:$(this).find(".urlTxt"),btn:$(this).find(".btnCopy"),parent:$(this).parents(".tabArea")};var c=$(this).parents(".tabArea").attr("id");c=c.split("_");c=c[1];if(c=="search"||c=="discover"){a.queryBar[b].txt.val(queryBeg+c+".json?limit=20")}else{a.queryBar[b].txt.val(queryBeg+c+".json?")}});$('input[value="Run"]').parents("form").submit(function(){var c=$(this);if(updateString==undefined){b()}else{setTimeout(function(){b()},750)}var b=function(){var d={item:c.parents(".tabArea"),name:c.parents(".tabArea").attr("id")};d.name=d.name.split("_");d.name=d.name[1];if(d.name!="advanced"){var e=d.item.find(".urlTxt").val()}else{var e=$("#"+d.name+"_string").val()}switch(d.name){case"advanced":a.customQuery(e);break;case"search":a.searchQuery(e);break;case"discover":a.discoverQuery(e);break;case"schedule":a.scheduleQuery(e);break;case"content":a.contentQuery(e);break}};return false})};ApiExplorer.prototype.customQuery=function(b,d){var c=this;c.queryType="advanced";var a=c.holder.find("#advanced_string");a.val(b);c.query=queryBeg+b;if(d!=false){c.runQuery(4)}else{a.focus()}};ApiExplorer.prototype.searchQuery=function(c){var d=this;d.queryType="search";var a=getParamByName("q",c);var b=getParamByName("publisher",c);if(a.length>0){$("#search_title").val(a).change()}if(b.length>0){$("#search_publisher").val(b).change()}d.query=c;d.runQuery(0)};ApiExplorer.prototype.discoverQuery=function(b){var d=this;d.queryType="discover";var a=getParamByName("publisher",b);var c=getParamByName("genre",b);if(c.length>0){$("#discover_genre").val(c).change()}if(a.length>0){$("#discover_publisher").val(a).change()}d.query=b;d.runQuery(1)};ApiExplorer.prototype.scheduleQuery=function(e){var g=this;g.queryType="schedule";var a=getParamByName("channel",e);var b=getParamByName("from",e);var f=getParamByName("to",e);if(isNaN(parseFloat(b))){b=timeConvertor(b)}if(isNaN(parseFloat(f))){f=timeConvertor(f)}$("#schedule_channel").val(a).change();var d=new Date(b*1000);var c=new Date(f*1000);$("#schedule_from").val(b).datepicker("setDate",d);$("#schedule_to").val(f).datepicker("setDate",c);g.query=e+"&publisher=bbc.co.uk,itv.com";g.runQuery(2)};ApiExplorer.prototype.contentQuery=function(a){var b=this;b.queryType="content";$("#content_uri").val(getParamByName("uri",a)).change();b.query=a;b.runQuery(3)};var getParamByName=function(c,b){c=c.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var a="[\\?&]"+c+"=([^&#]*)";var e=new RegExp(a);var d=e.exec(b);if(d==null){return""}else{return decodeURIComponent(d[1].replace(/\+/g," "))}};ApiExplorer.prototype.runQuery=function(b){var c=this;if(c.btn.siblings(".msg:visible")){c.btn.siblings(".msg").fadeOut()}c.btn.val("Please Wait").addClass("inactive");if(c.queryType!="advanced"){c.queryBar[b].txt.val(c.query)}$("#currentQuery").val(c.query);var a=c.query;$.ajax({url:a,dataType:"jsonp",jsonpCallback:"jsonp",cache:true,timeout:5000,context:c.holder,success:function(k,l,j){var d;if(k.contents!=undefined){d=k.contents}else{d=k.schedule[0].items}var g=processTheJson(k);g.clean(undefined);if(g.length>5){g=g.slice(0,5)}c.queryBar[b].parent.find(".resultsArea .preview .showItem").each(function(n){var o=$(this);var p=$(this).find("img");var m=$(this).find(".caption");o.addClass("loading");p.fadeOut();m.fadeOut();if(g[n]!=undefined){p.attr("src",""+g[n].image+"");m.find(".br").html(g[n].brand);m.find(".pub").html("("+g[n].publisher+")");m.find(".ep").html(g[n].episode);o.attr("href",queryBeg+"content.json?uri="+g[n].uri).addClass("apiContent");m.fadeIn();p.fadeIn();o.fadeIn()}else{o.fadeOut()}o.removeClass("loading")});var d;if(k.contents!=undefined){if(k.contents.length>2){k.contents=k.contents.slice(0,2)}d=k.contents}var e=a.replace("json","xml");var f=a.replace("json","html");var h=a.replace("json","rdf.xml");$('a[data-tab="'+c.queryType+'_xml"]').attr("href",e);$('a[data-tab="'+c.queryType+'_html"]').attr("href",f);$('a[data-tab="'+c.queryType+'_rdf"]').attr("href",h);$("#"+c.queryType+"_json").html(c.prettyJson(d));if(c.queryBar[b].parent.find(".resultsArea:hidden")){c.queryBar[b].parent.find(".resultsArea").slideDown()}$(".object .btn").click(function(m){m.stopImmediatePropagation();if($(this).parent().hasClass("closed")){$(this).parent().removeClass("closed")}else{$(this).parent().addClass("closed")}return false});$(".array .btn").click(function(m){m.stopImmediatePropagation();if($(this).parent().hasClass("closed")){$(this).parent().removeClass("closed")}else{$(this).parent().addClass("closed")}return false})},error:function(d,f,e){sendMsg("error","Sorry, the following error occured: "+e)},complete:function(d,e){if(e=="timeout"){c.timedOut=true}c.btn.val("Run").removeClass("inactive");apiFuncRun=false}})};ApiExplorer.prototype.prettyJson=function(b){var c=this;var a=JSON.stringify(b,null,"&nbsp;");a=a.replace(/\</g,"&lt;");a=a.replace(/\>/g,"&gt;");a=prettyPrintOne(a);return a};Array.prototype.clean=function(b){for(var a=0;a<this.length;a++){if(this[a]==b){this.splice(a,1);a--}}return this};var sendMsg=function(a,c){if(c!=false){clearTimeout(c)}var d=this;var b=$("#msgs");b.addClass(a).html(c).slideDown();c=setTimeout(function(){b.slideUp()},5000)};var imageReplace=function(b,a){b.attr("src",a).bind("load",function(){if($(this).height()>0){$(this).fadeIn("slow")}else{return false}})};var timeConvertor=function(d){if(d=="now"){var c=new Date().getTime()/1000;return Math.round(c)}else{d=d.split(".");if(d.length==3){var a=d[2].match(/\D/i);switch(a[0]){case"s":case"S":a=1;break;case"m":case"M":a=60;break;case"h":case"H":a=3600;break;case"d":case"D":a=86400;break;case"w":case"W":a=604800;break;case"m":case"M":a=2629743;break;case"y":case"Y":a=31556926;break;default:a=0;break}var b=d[2].match(/\d*/i);if(d[0]=="now"){var c=new Date().getTime()/1000}if(a>0){if(d[1]=="plus"){c+=a*b;return Math.round(c)}else{if(d[1]=="minus"){c-=a*b;return Math.round(c)}}}}}};var SelectBox=function(a){this.item=a;this.option=[];this.current;this.input=a.siblings('input[type="hidden"]')};SelectBox.prototype.init=function(){var a=this;a.item.find(".option").each(function(b){a.option[b]={item:$(this),name:$(this).html(),val:$(this).attr("data-value")}});a.input.change(function(){var b=$(this).val();$.each(a.option,function(c){if(a.option[c].val==b){a.current=a.option[c]}});a.changeSelection()})};SelectBox.prototype.changeSelection=function(){var b=this;b.item.find(".option.selected").removeClass("selected");if(b.current.name!="none"){b.item.find(".value").html(b.current.name);b.current.item.addClass("selected")}else{b.item.find(".value").html("Please Select")}b.input.val(b.current.val);var a={item:b.input,title:b.input.attr("data-title"),val:b.input.val()};updateString(a)};var processTheJson=function(a){var b=[];if(a.contents!=undefined){if(a.contents.length>0){$.each(a.contents,function(c){if(a.contents[c].image!=undefined&&a.contents[c].image!=""){b[c]={brand:"",uri:"",publisher:"",episode:"",series:"",image:""};if(a.contents[c].title!=undefined){b[c].brand=a.contents[c].title}if(a.contents[c].uri!=undefined){b[c].uri=a.contents[c].uri}if(a.contents[c].publisher.name!=undefined){b[c].publisher=a.contents[c].publisher.name}if(a.contents[c].image!=undefined){b[c].image=a.contents[c].image}if(a.contents[c].content!=undefined&&a.contents[c].content.length!=0){if(a.contents[c].content[0].title!=undefined){if(a.contents[c].content[0].title!=a.contents[c].title){b[c].episode=a.contents[c].content[0].title}}if(a.contents[c].content[0].series_number!=undefined){b[c].series=a.contents[c].content[0].series_number}if(a.contents[c].content[0].image!=undefined){b[c].image=a.contents[c].content[0].image}}}else{b[c]=undefined}})}}else{if(a.schedule[0].items!=undefined){$.each(a.schedule[0].items,function(c){if(c<=20&&a.schedule[0].items[c].image!=undefined&&a.schedule[0].items[c].image!=""){b[c]={brand:"",uri:"",publisher:"",episode:"",series:"",image:""};if(a.schedule[0].items[c].title!=undefined){b[c].brand=a.schedule[0].items[c].title}if(a.schedule[0].items[c].uri!=undefined){b[c].uri=a.schedule[0].items[c].uri}if(a.schedule[0].items[c].publisher.name!=undefined){b[c].publisher=a.schedule[0].items[c].publisher.name}if(a.schedule[0].items[c].image!=undefined){b[c].image=a.schedule[0].items[c].image}if(a.schedule[0].items[c].episode_number!=undefined){if(a.schedule[0].items[c].brand_summary!=undefined&&a.schedule[0].items[c].brand_summary.title!=a.schedule[0].items[c].title){b[c].brand=a.schedule[0].items[c].brand_summary.title}if(a.schedule[0].items[c].title!=undefined){b[c].episode=a.schedule[0].items[c].title}}if(a.schedule[0].items[c].series_number!=undefined){b[c].series=a.schedule[0].items[c].series_number}if(a.schedule[0].items[c].image!=undefined){b[c].image=a.schedule[0].items[c].image}}else{b[c]==undefined}})}}return b};var updatingString;var updateString=function(h){var f={item:h.item.parents(".tabArea"),name:h.item.parents(".tabArea").attr("id")};f.name=f.name.split("_");f.name=f.name[1];if(f.name=="search"&&h.title=="title"){h.title="q"}if(h.title=="limit"){var l=parseInt(h.val);if(l>50){h.val="50";h.item.val("50")}if(l==0){h.val="1";h.item.val("1")}}if(h.title=="from"||h.title=="to"){var j=h.val.match(/(.*?)\//g);var b=h.val.match(/\d{4}/g);h.val=toTimestamp(parseInt(b[0]),parseInt(j[1]),parseInt(j[0]),0,0,0)}var c=f.item.find(".urlCopy .urlTxt");var k=c.val();if(k!=null){k=k.replace("&amp;","&")}else{k=""}var m;if(k.search(h.title+"=")!=-1){k=k.replace("&amp;","&");var g=getParamByName(h.title,k);var d=k.substr(0,k.search(h.title));var a=(h.title.length+1)+g.length;var e=k.substr(k.search(h.title)+a);if(e.substr(0,1)=="&"){if(h.val.length>0){e=e.substr(1)+"&"}}d=d.replace("&amp;","&");e=e.replace("&amp;","&");if(h.val.length>0){m=d+h.title+"="+h.val+"&"+e}else{if(e.substr(0,1)=="&"){e=e.substr(1)}m=d+e}}else{if(k.search(/\?/g)!=-1){if(k.substr(k.search(/\?/g)+1).length!=0){m=k+"&"+h.title+"="+h.val}else{m=k+h.title+"="+h.val}}else{m=queryBeg;if(f.name!="advanced"){m+=f.name}else{m+="discover"}m+=".json?"+h.title+"="+h.val}}if(m.substr(-1)=="&"){m=m.substr(0,m.length-1)}m=m.replace("&amp;","&");c.val(m)};function jsonp(){}function toTimestamp(e,f,c,a,g,d){var b=new Date(Date.UTC(e,f-1,c,a,g,d));return b.getTime()/1000}$(document).ready(function(){var c=new PageInfo();c.init();$("section:not(.subSection):last-child").css("min-height",c.pageHeight-148);var b=new Tabs();b.init($("#explorerWrapper"));b.changeTab(0);var f=new ApiExplorer($("#explorerWrapper"));f.buttonHandler();var e=[];$(".select").each(function(g){e[g]=new SelectBox($(this));e[g].init();$(this).find(".option").click(function(){e[g].current={item:$(this),name:$(this).html(),val:$(this).attr("data-value")};e[g].changeSelection();e[g].item.find(".options").hide()});$(this).hover(function(){$(this).find(".options").show()},function(){$(this).find(".options").hide()})});var d=new HomeDemo($(".controlBar"));d.init();$(".subTab a").click(function(){return false});$("a.apiSearch").click(function(){if(apiFuncRun==false){b.changeTab(0);f.searchQuery($(this).attr("href"));if($.browser.msie&&$.browser.version.substr(0,1)<=7){$('a[href="#apiExplorer"]').click()}else{window.location.hash="apiExplorer"}apiFuncRun=true;return false}});$("a.apiDiscover").click(function(){if(apiFuncRun==false){b.changeTab(1);f.discoverQuery($(this).attr("href"));if($.browser.msie&&$.browser.version.substr(0,1)<=7){$('a[href="#apiExplorer"]').click()}else{window.location.hash="apiExplorer"}apiFuncRun=true;return false}});$("a.apiSchedule").click(function(){if(apiFuncRun==false){b.changeTab(2);f.scheduleQuery($(this).attr("href"));if($.browser.msie&&$.browser.version.substr(0,1)<=7){$('a[href="#apiExplorer"]').click()}else{window.location.hash="apiExplorer"}apiFuncRun=true;return false}});$("a.apiContent").click(function(){if(apiFuncRun==false){b.changeTab(3);f.contentQuery($(this).attr("href"));if($.browser.msie&&$.browser.version.substr(0,1)<=7){$('a[href="#apiExplorer"]').click()}else{window.location.hash="apiExplorer"}apiFuncRun=true;return false}});$("a.api").click(function(){if(apiFuncRun==false){b.changeTab(4);f.customQuery($(this).attr("href"));if($.browser.msie&&$.browser.version.substr(0,1)<=7){$('a[href="#apiExplorer"]').click()}else{window.location.hash="apiExplorer"}apiFuncRun=true;return false}});$(".urlCopy .urlTxt").click(function(){$(this).select();return false});$(".urlCopy .urlTxt").keyup(function(h){var g=$(this).val();if(h.keyCode!=37&&h.keyCode!=38&&h.keyCode!=39&&h.keyCode!=40){g=g.substr(g.indexOf("0/")+2);g=g.replace(/\&amp\;/g,"&");g=g.replace(queryBeg,"");b.changeTab(4);f.customQuery(g,false)}return false});$(".watchMe").keyup(function(h){if(h.keyCode!=37&&h.keyCode!=38&&h.keyCode!=39&&h.keyCode!=40){clearTimeout(updatingString);var g={item:$(this),title:$(this).attr("data-title"),val:$(this).val()};updatingString=setTimeout(function(){updateString(g)},500)}});$(".watchMe").change(function(h){clearTimeout(updatingString);var g={item:$(this),title:$(this).attr("data-title"),val:$(this).val()};updatingString=setTimeout(function(){updateString(g)},500)});$("input.date").datepicker({showOn:"button",buttonImage:"images/date.gif",buttonImageOnly:true,dateFormat:"dd/mm/yy"});$(".mainMenu a").click(function(){c.menuClick=true;var g=$(this).parent().index();if(g>=0){$(document).scrollTop(c.section[g].position);c.changePage(g)}});$(".subNav a").click(function(){var g=$(this).parent().index();if(g>=0){$(document).scrollTop(c.section[c.currentSection].subSection[g].position);c.changeSubSection(g)}});$('a[href="#apiExplorer"]').click(function(){$(document).scrollTop(c.section[c.sections].position);c.changeSubSection(c.sections)});$(window).scroll(function(g){c.currentEvent=g;c.update(false,false,true)});var a;$(".hov").bind("mouseover",function(){var h=$(this);var g=$(this).height();a=setTimeout(function(){if(h.find(".hover").length==0){if(!h.hasClass("hovDown")){$('.hover[data-title="'+h.attr("data-title")+'"]').clone().css({bottom:g+5}).appendTo(h).fadeIn("fast")}else{$('.hover[data-title="'+h.attr("data-title")+'"]').clone().css({top:g+5}).appendTo(h).fadeIn("fast")}}else{h.find(".hover").fadeIn("fast")}},500);$(".hov").bind("mouseout",function(){clearTimeout(a);h.find(".hover").fadeOut("fast")})})});var JSON;if(!JSON){JSON={}}(function(){function f(n){return n<10?"0"+n:n}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(key){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(key){return this.valueOf()}}var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;function quote(string){escapable.lastIndex=0;return escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];return typeof c==="string"?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+string+'"'}function str(key,holder){var i,k,v,length,mind=gap,partial,value=holder[key];if(value&&typeof value==="object"&&typeof value.toJSON==="function"){value=value.toJSON(key)}if(typeof rep==="function"){value=rep.call(holder,key,value)}switch(typeof value){case"string":return quote(value);case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value){return"null"}gap+=indent;partial=[];if(Object.prototype.toString.apply(value)==="[object Array]"){length=value.length;for(i=0;i<length;i+=1){partial[i]=str(i,value)||"null"}v=partial.length===0?"[]":gap?"[\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"]":"["+partial.join(",")+"]";gap=mind;return v}if(rep&&typeof rep==="object"){length=rep.length;for(i=0;i<length;i+=1){if(typeof rep[i]==="string"){k=rep[i];v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}else{for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}v=partial.length===0?"{}":gap?"{\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"}":"{"+partial.join(",")+"}";gap=mind;return v}}if(typeof JSON.stringify!=="function"){JSON.stringify=function(value,replacer,space){var i;gap="";indent="";if(typeof space==="number"){for(i=0;i<space;i+=1){indent+=" "}}else{if(typeof space==="string"){indent=space}}rep=replacer;if(replacer&&typeof replacer!=="function"&&(typeof replacer!=="object"||typeof replacer.length!=="number")){throw new Error("JSON.stringify")}return str("",{"":value})}}if(typeof JSON.parse!=="function"){JSON.parse=function(text,reviver){var j;function walk(holder,key){var k,v,value=holder[key];if(value&&typeof value==="object"){for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined){value[k]=v}else{delete value[k]}}}}return reviver.call(holder,key,value)}text=String(text);cx.lastIndex=0;if(cx.test(text)){text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})}if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof reviver==="function"?walk({"":j},""):j}throw new SyntaxError("JSON.parse")}}}());